/* HAVING 실습 */
-- 1 .각 부서별 평균 급여 400만원 이상 부서
SELECT DEPT_CODE "부서 명", AVG(SALARY) "평균 급여" FROM EMPLOYEE
GROUP BY DEPT_CODE HAVING AVG(SALARY) >= 4000000;


-- 2. 각 부서별 직원 수 5명 이상인 부서 조회
SELECT DEPT_CODE "부서 명", COUNT(*) "직원 수" FROM EMPLOYEE
GROUP BY DEPT_CODE HAVING count(*) >= 5;

-- 3. 각 부서별 보너스 평균이 0.2 이상인 부서 조회
SELECT DEPT_CODE "부서 명", AVG(BONUS) "보너스 평균" FROM EMPLOYEE
GROUP BY DEPT_CODE HAVING AVG(BONUS)>=0.2;

--4. 각 직급 별 최소 급여가 300만 이하인 직급 조회
SELECT JOB_CODE "직급", MIN(SALARY) "최소 급여" FROM EMPLOYEE
GROUP BY JOB_CODE HAVING MIN(SALARY) <=3000000;

--5. EMPLOYEE 테이블에서 부서별 70년대 생 급여 평균이 300만 이상인 부서를 조회하고
-- 부서 코드 오름차순정렬

SELECT DEPT_CODE "부서 명", AVG(SALARY) "급여 평균" FROM EMPLOYEE
WHERE SUBSTR(EMP_NO,1,2) BETWEEN 70 AND 79
GROUP BY DEPT_CODE HAVING  AVG(SALARY) >= 3000000 ORDER BY DEPT_CODE;

--누군가의 매니저인 사원의 이름과 EMP_ID 를 출력하시오

SELECT DISTINCT MANAGER_ID FROM EMPLOYEE WHERE MANAGER_ID IS NOT NULL;

SELECT DISTINCT MANAGER_ID FROM EMPLOYEE WHERE MANAGER_ID IS NOT NULL;

SELECT DISTINCT
E2.*
FROM EMPLOYEE E1
INNER JOIN EMPLOYEE E2
ON E1.MANAGER_ID =E2.EMP_ID
WHERE E1.MANAGER_ID IS NOT NULL;

